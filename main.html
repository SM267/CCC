<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Eventify | Explore Events</title>
<style>
body{background-color:#0d0d1b;color:#fff;font-family:'Poppins',sans-serif;margin:0;padding:0}
nav{display:flex;justify-content:space-between;align-items:center;background:#1a1a2e;padding:15px 40px}
nav h1{color:#a855f7}
nav button{background:#6c63ff;border:none;padding:8px 16px;color:#fff;border-radius:8px;cursor:pointer}
.container{padding:40px}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:25px}
.card{background:#1e1e2f;border-radius:14px;overflow:hidden;padding:15px;text-align:center}
.card img{width:100%;height:180px;object-fit:cover;border-radius:10px}
.price{color:#a855f7;font-weight:bold;margin:5px 0}
button{cursor:pointer}
</style>
</head>
<body>
<nav>
  <h1>Eventify</h1>
  <div>
    <button onclick="viewBookings()">View My Bookings</button>
    <button onclick="logout()">Logout</button>
  </div>
</nav>
<div class="container" id="mainContainer"></div>

<script>
const backendURL = "https://your-render-backend.onrender.com"; // Replace this with your Render backend URL

const events = [
  {title:"Indie Rock Night",city:"Bengaluru",price:499,date:"2025-11-30",image:"https://images.unsplash.com/photo-1507874457470-272b3c8d8ee2?auto=format&fit=crop&w=800&q=60"},
  {title:"Startup Workshop",city:"Pune",price:299,date:"2025-12-02",image:"https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=800&q=60"},
  {title:"Beach Music Fest",city:"Goa",price:599,date:"2025-12-05",image:"https://images.unsplash.com/photo-1521334884684-d80222895322?auto=format&fit=crop&w=800&q=60"}
];

const container = document.getElementById("mainContainer");

function renderEvents(){
  container.innerHTML = "";
  events.forEach(e => {
    const card = document.createElement("div");
    card.className = "card";
    card.innerHTML = `
      <img src="${e.image}" alt="${e.title}">
      <h3>${e.title}</h3>
      <p>${e.city} â€¢ ${e.date}</p>
      <p class="price">â‚¹${e.price}</p>
      <button onclick="bookEvent('${e.title}')">Book</button>`;
    container.appendChild(card);
  });
}

function bookEvent(title){
  const userEmail = localStorage.getItem("userEmail");
  if(!userEmail) return alert("Please log in first!");
  fetch(\`\${backendURL}/api/book\`,{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({eventTitle:title,userEmail})
  })
  .then(r=>r.json())
  .then(()=>alert("ðŸŽŸï¸ Booking confirmed!"))
  .catch(()=>alert("âŒ Booking failed. Try again."));
}

function viewBookings(){
  const userEmail = localStorage.getItem("userEmail");
  if(!userEmail) return alert("Please log in first!");
  fetch(\`\${backendURL}/api/bookings?userEmail=\${userEmail}\`)
    .then(res=>res.json())
    .then(data=>{
      if(data.length===0) alert("No bookings yet.");
      else alert("ðŸ“‹ Your Bookings:\n" + data.map(b=>b.eventTitle).join("\n"));
    })
    .catch(()=>alert("Error fetching bookings."));
}

function logout(){
  localStorage.removeItem("userEmail");
  window.location.href="login.html";
}

renderEvents();
</script>
</body>
</html>
